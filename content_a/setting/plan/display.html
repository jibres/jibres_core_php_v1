{%extends "content_a/setting/layout.html"%}




{%block data%}
<div class="cbox">
  {{block('currentPlan')}}
</div>

{%if perm_su()%}
<div class="cbox">
  <div class="f txtC">
    <div class="c3 pRa5">
      <div data-confirm  data-data='{"plan" : "simple", "period" : "monthly"}' class="msg success">simple monthly</div></div>
    <div class="c3 pRa5"><div data-confirm  data-data='{"plan" : "simple", "period" : "yearly"}' class="msg success">simple yearly</div></div>
    <div class="c3 pRa5"><div data-confirm  data-data='{"plan" : "standard", "period" : "monthly"}' class="msg success">standard monthly</div></div>
    <div class="c3 pRa5"><div data-confirm  data-data='{"plan" : "standard", "period" : "yearly"}' class="msg success">standard yearly</div></div>
    <div class="c3 pRa5"><div data-confirm  data-data='{"plan" : "free"}' class="msg success">free</div></div>
  </div>
</div>
{%endif%}
<form method="post">

{{block('iChangePlan')}}
</form>



{%endblock%}


{%block iChangePlan%}
<div class="cbox">
   <a class="msg success2 block txtC mT20" href="{{url.site}}/pricing" data-direct target="_blank">{%trans "Need help to choose plan? Check our pricing or call us"%}</a>
    {{block ("iplan")}}
    <div data-response='plan' data-response-hide data-response-where="simple|standard">
    {{block ("iperiod")}}
    </div>

    <div data-response='plan' data-response-hide data-response-effect='slide' data-response-where="simple|standard">
      <div data-response='period' data-response-hide data-response-effect='slide' data-response-where="1m|12m">
        {{block('iPromo')}}
        <div class="msg info2 mT20 f" id='price'>
          <div class="c">{%trans "Your bill total"%}</div>
          <div class="cauto">
            <span class="txtB"></span>
            <small>{%trans "Toman"%}</small>
          </div>
        </div>

        <button class="btn primary block mT20">{%trans "Register store and pay"%}</button>
      </div>
    </div>

    <div data-response='plan' data-response-hide data-response-where="free">
      <button class="btn primary block mT20">{%trans "Change your store to free plan"%}</button>
    </div>
</div>
{%endblock%}


{%block iBuyPlan%}
<div class="cbox">
   <a class="msg success2 block txtC mT20" href="{{url.site}}/pricing" data-direct target="_blank">{%trans "Need help to choose plan? Check our pricing or call us"%}</a>
    {{block ("iplan")}}
    <div data-response='plan' data-response-hide data-response-where="simple|standard">
    {{block ("iperiod")}}
    </div>

    <div data-response='plan' data-response-hide data-response-effect='slide' data-response-where="simple|standard">
      <div data-response='period' data-response-hide data-response-effect='slide' data-response-where="1m|12m">
        {{block('iPromo')}}
        <div class="msg info2 mT20 f" id='price'>
          <div class="c">{%trans "Your bill total"%}</div>
          <div class="cauto">
            <span class="txtB"></span>
            <small>{%trans "Toman"%}</small>
          </div>
        </div>

        <button class="btn primary block mT20">{%trans "Register store and pay"%}</button>
      </div>
    </div>

    <div data-response='plan' data-response-hide data-response-where="free">
      <button class="btn primary block mT20">{%trans "Change your store to free plan"%}</button>
    </div>
</div>
{%endblock%}






{%block currentPlan%}
  <h3>
    <small>{%trans "Current Plan"%}</small> <b>{%set myPlan = store.plan | capitalize%}{%trans myPlan%}</b>
    {%if store.expireplan %}<small class="badge floatRa" title='{{store.expireplan | dt(true)}}'>{%trans "Expire on"%} {{store.expireplan | dt}}</small>{%endif%}
  </h3>
{%endblock%}


{%block planHistoryTable%}
<table class="tbl1 v6 fs12">
  <thead class="">
    <tr>
      <th>{%trans "Plan"%}</th>
      <th>{%trans "Start"%}</th>
      <th>{%trans "End"%}</th>
      <th>{%trans "Status"%}</th>
    </tr>
  </thead>

  <tbody>
    {%for key, value in dataTable%}
    <tr >
      <td>{%set my_plan = value.plan | capitalize%}{%trans my_plan%}</td>
      <td>{{value.start | dt(true)}}</td>
      <td>{{value.end | dt(true)}}</td>
      <td>{%set my_status = value.status | capitalize%}{%trans my_status%}</td>

    </tr>
    {%endfor%}
  </tbody>
</table>
{%endblock%}



{%block iexpireplan%}
<label for="expireplan">{%trans "Plan expire date"%}  <small class="fc-red">* {%trans "Require"%}</small></label>
<div class="input">
  <input class="datepicker" type="text" name="expireplan" id="expireplan" placeholder='{{"1369/04/15" | fitNumber}} *' value="{{store.expireplan}}" data-view="year" autocomplete='off'>
</div>
{%endblock%}










{%block iPromo%}
<label for="promo" class="mT10">{%trans "Promo code"%}</label>
<div class="input">
  <input type="text" name="promo" id="promo" placeholder='{%trans "Promo code"%}' maxlength='30' pattern=".{1,30}" title='{%trans "If you have promo code, enter it to give some discount!"%}' needREVIEW-data-check='{{url.this}}/add?check=promo'>
</div>
{%endblock%}




{%block iplan%}
 <p class="mT10">{%trans "Choose your plan"%} <span class="fc-red">*</span></p>
  {%if store.plan != 'free'%}
    <div class="radio1">
      <input type="radio" id="plan-free" name="plan" value="free">
      <label for="plan-free">{%trans "Free"%}</label>
    </div>
  {%endif%}

  {%if store.plan != 'simple'%}
    <div class="radio1">
      <input type="radio" id="plan-simple" name="plan" value="simple" data-1m='100000' data-12m='1000000'>
      <label for="plan-simple">{%trans "Simple"%}</label>
    </div>
  {%endif%}


  {%if store.plan != 'standard'%}
    <div class="radio1">
      <input type="radio" id="plan-12m" name="plan" value="standard" data-1m='500000' data-12m='5000000'>
      <label for="plan-12m">{%trans "Standard"%}</label>
    </div>
  {%endif%}

{%endblock%}


{%block iperiod%}
    <p class="mT10">{%trans "Choose your plan period"%} <span class="fc-red">*</span></p>

    <div class="radio1">
      <input type="radio" id="period-1m" name="period" value="1m">
      <label for="period-1m">{%trans "Pay monthly"%}</label>
    </div>


    <div class="radio1">
      <input type="radio" id="period-12m" name="period" value="12m">
      <label for="period-12m">{%trans "Pay yearly"%} - {%trans "two month is free"%}</label>
    </div>


{%endblock%}


{%block foot_js%}
<script type="text/javascript">
  function pushStateFinal()
  {
    $('#plan').off('change');
    $('#period').off('change');
    $('#plan').on('change', function(){ calcTotalPlanPrice(); });
    $('#period').on('change', function(){ calcTotalPlanPrice(); });
  }


  function calcTotalPlanPrice()
  {
    var myPlanRow = $('#plan option[value="' + $('#plan').val() + '"]');
    var myPeriod  = $('#period').val();
    var myPrice   = fitNumber(1000);

    var myPrice = myPlanRow.attr('data-'+ myPeriod);
    if(!myPrice)
    {
      myPrice = '-';
    }
    $('#price span').text(fitNumber(myPrice));

    return myPrice;
  }
</script>
{%endblock%}




