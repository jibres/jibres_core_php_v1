{%extends display.admin%}


{%block pageContent%}

{%if dataTable%}
 {%if filterBox%}

  {{block('htmlSearchBox')}}
  {{block('htmlTable')}}
  {{block('htmlFilter')}}

 {%else%}

  {{block('htmlSearchBox')}}
  {{block('htmlTable')}}

 {%endif%}
{%else%}
 {%if filterBox%}

  {{block('htmlSearchBox')}}
  {{block('htmlFilterNoResult')}}

 {%else%}

  {{block('htmlStartAddNew')}}

 {%endif%}
{%endif%}

{%endblock%}




{%block pageContent3%}

{%if dataTable%}
{{block('searchblock')}}
<div class="cbox fs12">
{{block('datatable')}}
</div>


{%elseif requestGET.q%}
{{block('searchblock')}}
<div class="fs14 msg warn2 pA25">
 {%trans "No factor founded."%} {%trans "Search with new keywords or barcode."%}
 <a class="badge primary pA10" href="{{url.this}}/add{{moduleTypeP}}" data-shortkey2="119">{%trans "Add new factor"%}</a>
</div>

{%else%}
<div class="cbox fs12">
 <h3>{%trans "You are not have factor yet! add new one."%}</h3>
 <a class="btn primary mT10 pLR50" href="{{url.this}}/add{{moduleTypeP}}">{%trans "Add new factor"%}</a>
</div>
{%endif%}

{%endblock%}


{%block pageContent2%}

{%if dataTable%}
  <div class="">
    <form method="get" data-action class="cbox">
      <div class="input">
        <input type="text" name="search" placeholder='{%trans "Search in factors list"%}' id="search" value="{{requestGET.search}}">
        <button class="addon btn ">{%trans "Search" %}</button>
      </div>
    </form>




{%else%}
<p class="msg info2">{%trans "You are not register any factor yet!"%} <a href="{{url.this}}/add{{moduleTypeP}}">{%trans "Add new factor"%}</a></p>
{%endif%}
    <a href="{{url.this}}/add" class="btn primary block">{%trans "Add new factor"%}</a>
  </div>

{%endblock%}



{%block htmlSearchBox%}
<div class="cbox fs12">
  <form method="get" action="{{url.this}}">
    <div class="input">
      <input type="search" name="q" placeholder='{%trans "Search in factors list"%}' id="q" value="{{requestGET.q}}" autofocus class="barCode" data-default data-pass='submit' autocomplete='off'>
      {%if requestGET.type%}
        <input type="hidden" name="type" value="{{requestGET.type}}">
      {%endif%}
      <button class="addon btn ">{%trans "Search" %}</button>
    </div>
  </form>
</div>
{%endblock%}


{%block htmlTable%}
  <table class="tbl1 v1 cbox fs12">
    <thead>
      <tr>
        <th data-sort="{{myFilter.date.order}}"><a href="{{myFilter.date.link}}">{%trans "Invoice Date"%}</a></th>
        <th data-sort="{{myFilter.customer.order}}"><a href="{{myFilter.customer.link}}">{%trans "Customer"%}</a></th>
        <th data-sort="{{myFilter.type.order}}"><a href="{{myFilter.type.link}}">{%trans "Type"%}</a></th>
        <th data-sort="{{myFilter.item.order}}"><a href="{{myFilter.item.link}}">{%trans "Items"%}</a></th>
        <th data-sort="{{myFilter.qty.order}}"><a href="{{myFilter.qty.link}}">{%trans "Qty"%}</a></th>
        <th data-sort="{{myFilter.detailsum.order}}"><a href="{{myFilter.detailsum.link}}">{%trans "Price"%}</a></th>
        <th data-sort="{{myFilter.detaildiscount.order}}"><a href="{{myFilter.detaildiscount.link}}">{%trans "Discount"%}</a></th>
        <th data-sort="{{myFilter.detailtotalsum.order}}"><a href="{{myFilter.detailtotalsum.link}}">{%trans "Total"%}</a></th>
      </tr>

    </thead>
    <tbody>
      {%for key, value in dataTable%}
        <tr>
          <td><a href="{{url.this}}/fishprint?id={{value.id}}&size=receipt8">{{value.date | dt(true, 'date')}} <b class="floatRa">{{value.date | dt(true, 'time')}}</b></a></td>
          <td>
          {%if value.customer%}
            <a href="{{url.this}}?customer={{value.customer}}">
              {{value.customer_firstname}} <b>{{value.customer_lastname}}</b>
            </a>
          {%else%}
            <i class="disabled">-</i>
          {%endif%}
          <td>{%set myType = value.type | capitalize%}<a href="{{url.this}}?type={{value.type}}">{%trans myType%}</a></td>
          </td>
          <td>{{value.item| number_format | fitNumber}}</td>
          <td>{{value.qty| number_format | fitNumber}}</td>
          <td>{{value.detailsum| number_format | fitNumber}}</td>
          <td>{{value.detaildiscount| number_format | fitNumber}}</td>
          <td>{{value.detailtotalsum| number_format | fitNumber}}</td>
        </tr>
      {%endfor%}
    </tbody>
  </table>
    {%include display.pagination%}
{%endblock%}



{%block footer2%}
  <a class="c btn mA10" href='{{url.this}}/add?type=sale'>{%trans "Sale"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=buy'>{%trans "Buy"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=prefactor'>{%trans "Prefactor"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=lending'>{%trans "Lending"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=backbuy'>{%trans "Backbuy"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=backfactor'>{%trans "Backfactor"%}</a>
  <a class="c btn mA10" href='{{url.this}}/add?type=waste'>{%trans "Waste"%}</a>
{%endblock%}



{%block htmlFilter%}
<p class="f fs14 msg warn2 mT20">
  <span class="c">{{filterBox | raw}}</span>
  <a class="cauto" href="{{url.this}}{{moduleTypeP}}">{%trans "Clear filters"%}</a>
</p>
{%endblock%}


{%block htmlFilterNoResult%}
<p class="f fs14 msg warn2">
  <span class="c">{%trans "Result not found!"%} {%trans "Search with new keywords."%}</span>
  <a class="cauto" href="{{url.this}}{{moduleTypeP}}">{%trans "Clear filters"%}</a>
</p>
{%endblock%}


{%block htmlStartAddNew%}
<p class="fs14 msg success2 pTB20">{%trans "Hi!"%} <a href="{{url.this}}/add{{moduleTypeP}}">{%trans "Try to start with add new factor!"%}</a></p>
{%endblock%}
