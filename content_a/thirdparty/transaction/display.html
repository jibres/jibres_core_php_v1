{%extends "content_a/thirdparty/layout.html"%}

{%block pageContent%}
{{block ("pageSteps")}}
{{block ("pageStepsBilling")}}




<div class="f">
 <div class="c3 s12 pRa10">
    {{block("psidebar")}}
 </div>
 <div class="c9 s12">
 	{{block('transactionList')}}
 </div>
</div>


{%endblock%}



{%block transactionList%}

{%if dataTable%}

  {%if dataFilter%}

    {{block('htmlSearchBox')}}
    {{block('htmlTable')}}
    {{block('htmlFilter')}}

  {%else%}

    {{block('htmlSearchBox')}}
    {{block('htmlTable')}}

  {%endif%}

{%else%}

  {%if requestGET.q%}

    {{block('htmlSearchBox')}}
    {{block('htmlFilterNoResult')}}

  {%else%}

    {{block('htmlStartAddNew')}}

  {%endif%}

{%endif%}
{%endblock%}




{%block htmlSearchBox%}
<div class="cbox fs12">
  <form method="get">
    <div class="input">
      <input type="hidden" name="id" value="{{requestGET.id}}">
      <input type="hidden" name="action" value="list">
      <input type="search" name="q" placeholder='{%trans "Search in transactions"%}' id="q" value="{{requestGET.q}}" autofocus  data-pass='submit' autocomplete='off'>
      <button class="addon btn ">{%trans "Search" %}</button>
    </div>
  </form>
</div>
{%endblock%}


{%block htmlTable%}
<div class="cbox fs12">

  <table class="tbl">
    <thead>
      <tr>
        <th class="s0">{%trans "Title" %}</th>
        <th data-sort="{{sortLink.date.order}}"><a href='{{sortLink.date.link}}'>{%trans "Date" %}</th>
        <th data-sort="{{sortLink.plus.order}}"><a href='{{sortLink.plus.link}}'>{%trans "Plus" %}</a></th>
        <th data-sort="{{sortLink.minus.order}}"><a href='{{sortLink.minus.link}}'>{%trans "Minus" %}</a></th>
        <th data-sort="{{sortLink.budget.order}}"><a href='{{sortLink.budget.link}}'>{%trans "Budget After" %}</a></th>
        <th data-sort="{{sortLink.paytype.order}}"><a href='{{sortLink.paytype.link}}'>{%trans "Type" %}</a></th>
        <th>{%trans "Description"%}</th>
      </tr>
    </thead>
    <tbody>

      {% for key, value in dataTable %}
      {%set my_unit = value.unit%}
      {%set my_title = value.title%}
      {%set my_paytype = value.paytype | capitalize%}

      <tr>
        <td class="s0">{%trans my_title%}</td>
        <td title='{{value.date | dt(true)}}'>{{value.date | dt("human")}}</td>
        <td>{%if value.plus%}+ {{value.plus|number_format|fitNumber}}{%endif%}</td>
        <td>{%if value.minus%}- {{value.minus|number_format|fitNumber}}{%endif%}</td>
        <td>{{value.budget|number_format|fitNumber}} {%trans my_unit%}</td>
        <td><a href="{{url.this}}/billing?id={{requestGET.id}}&action=list&paytype={{value.paytype}}">{%trans my_paytype%}</a></td>
        <td>
          {%if value.bank%}<b title='{%trans "Bank"%}'>{%set myBank = value.bank | capitalize %}{%trans myBank%}</b>{%endif%}
          {%if value.trackid%}<span title='{%trans "Track id"%}' class="badge">{{value.trackid| fitNumber(false)}}</span>{%endif%}
        {{value.desc}}</td>
      </tr>
      {%endfor%}

    </tbody>
  </table>
  {%include display.pagination%}

</div>
{%endblock%}


{%block htmlFilter%}
<p class="f fs14 msg info2">
  <span class="c">{{dataFilter | raw}}</span>
  <a class="cauto" href="{{url.this}}/billing?id={{requestGET.id}}&action=list">{%trans "Clear filters"%}</a>
</p>
{%endblock%}


{%block htmlFilterNoResult%}
<p class="f fs14 msg warn2">
  <span class="c">{%trans "Result not found!"%} {%trans "Search with new keywords."%}</span>
  <a class="cauto" href="{{url.this}}/billing?id={{requestGET.id}}&action=list">{%trans "Clear filters"%}</a>
</p>
{%endblock%}


{%block htmlStartAddNew%}
<p class="fs14 msg success2 pTB20">{%trans "No transaction found"%}</p>
{%endblock%}
